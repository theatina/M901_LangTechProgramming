Κεφάλαιο 1 – Εισαγωγή και ορισμοί
Είδη ψηφιακών εικόνων.
Κεφάλαιο 2 – Επεξεργασίες σε δυαδικές εικόνες
Κέντρο βάρος αντικειμένου
Κωδικοποίηση δυαδικής εικόνας κατά μήκος διαδρομής.
Ο μετασχηματισμός του Hough.
Κεφάλαιο 3 – Επεξεργασίες σε εικόνες αποχρώσεων του γκρι
Κατωφλίωση με βάση τη διασπορά
Κατωφλίωση με βάση την εντροπία
Πολυκατωφλίωση με χρήση νευρωνικού δικτύου
Κωδικοποίηση εικόνων αποχρώσεων του γκρι
Κωδικοποίηση 2Δ-διακριτού μετασχηματισμό συνημιτόνου
Εισαγωγή και ορισμοί
Η ψηφιακή επεξεργασία εικόνας (ΨΕΕ) αποτελεί έναν ευρύ επιστημονικό κλάδο που αναπτύχθηκε με την ραγδαία εξέλιξη των υπολογιστών.
Ο όρος εικόνα χρησιμοποιείται ευρύτερα από την απλή απεικόνιση ενός σκηνικού και περιλαμβάνει την αποτύπωση κάθε είδους πληροφοριών.
Τα υπερηχογραφήματα, οι μαγνητικές τομογραφίες, οι δορυφορικές φωτογραφίες κ.α. μπορούν να επεξεργαστούν ως ψηφιακές εικόνες.
Οι στόχοι της ΨΕΕ είναι οι εξής:
Η ψηφιοποίηση και κωδικοποίηση εικόνων με σκοπό την αποθήκευση, μετάδοση και
Η βελτίωση και η αποκατάσταση των εικόνων με σκοπό την καλύτερη απεικόνισή
Η ανάλυση και κατανόηση των εικόνων
Η ΨΕΕ συνεργάζεται με τους παρακάτω επιστημονικούς κλάδους:
Ψηφιακή Επεξεργασία Σημάτων (ΨΕΣ)
Η ψηφιακή εικόνα είναι ένα πεπερασμένο σύνολο περιοχών όπου κάθε περιοχή είναι χρωματισμένη με χρώμα που προέρχεται από ένα πεπερασμένο σύνολο χρωμάτων.
Στις περισσότερες των περιπτώσεων, μια ψηφιακή εικόνα είναι ένα ορθογώνιο, διαιρεμένο με γραμμές και στήλες σε ορθογώνιες περιοχές που κάθε μία έχει συγκεκριμένο χρώμα.
Μια τέτοια περιοχή ονομάζεται στοιχείο της εικόνας ή εικονοστοιχείο.
Στην αγγλική λέγεται pixel ή pel, όρος ο οποίος προέρχεται από τη σύντμηση των λέξεων picture element.
Από τα παραπάνω καταλαβαίνουμε πως μια ψηφιακή εικόνα είναι ένα διδιάστατο ψηφιακό σήμα.
Αν κάθε χρώμα κωδικοποιηθεί με έναν αριθμό τότε η ορθογώνια ψηφιακή εικόνα περιγράφεται από έναν πίνακα αριθμών J×K, όπου J το πλήθος των γραμμών και K το πλήθος των στηλών της ψηφιακής εικόνας.
Η τιμή I(j,k) με k=0,1,2….K-1 και j=0,1,2….J-1 είναι ο κωδικός του χρώματος της ψηφιακής εικόνας.
Η μετατροπή μιας εικόνας σε ψηφιακή μορφή ουσιαστικά είναι η μετατροπή ενός δισδιάστατου αναλογικού σήματος σε ψηφιακό και απαιτεί τις διαδικασίες της δειγματοληψίας και του κβαντισμού.
Είδη ψηφιακών εικόνων Υπάρχουν τρία είδη ψηφιακών εικόνων που χαρακτηρίζονται από το πλήθος των χρωμάτων που περιέχουν:
Δυαδικές εικόνες (binary images): Κάθε εικονοστοιχείο των εικόνων μπορεί να χρωματιστεί με ένα από δύο χρώματα.(συνήθως άσπρο ή μαύρο).
Για κάθε εικονοστοιχείο απαιτείται ένα bit πληροφορίας, π.χ. με τιμή μηδέν (0) για το μαύρο και ένα (1) για λευκό.
Οι εικόνες των εγγράφων που αποτελούνται μόνο από το χρώμα του χαρτιού και της μελάνης αναπαρίστανται σε δυαδική ψηφιακή μορφή.
Εικόνες αποχρώσεων του γκρι (gray level images): Κάθε εικονοστοιχείο των εικόνων μπορεί να χρωματιστεί με μία από τις αποχρώσεις του γκρι οι οποίες ξεκινούν από το μαύρο και καταλήγουν στο λευκό.
Από αυτές τις αποχρώσεις συνήθως λαμβάνονται 256 αντιπροσωπευτικές που κωδικοποιούνται με τιμές 0,1,2….255.
Η απόχρωση κάθε εικονοστοιχείου προφανώς απαιτεί πληροφορία ενός byte.
Έγχρωμες εικόνες (color images) στις οποίες κάθε εικονοστοιχείο χρωματίζεται με χρώματα που προέρχονται από την ανάμειξη των αποχρώσεων του κόκκινου, πράσινου και μπλε (RGB).
Για κάθε ένα από τα τρία αυτά χρώματα λαμβάνονται 256 αποχρώσεις δηλαδή πληροφορία του ενός byte.
Συνεπώς κάθε εικονοστοιχείο της έγχρωμης εικόνας, απαιτεί 3 bytes.
Το σύνολο των χρωμάτων που μπορούν να χρησιμοποιηθούν για τον χρωματισμό των εικονοστοιχείων της εικόνας λέγεται χρωματική παλέτα.
Εάν C είναι το πλήθος των χρωμάτων, τότε για την κωδικοποίησή τους απαιτούνται Β bits και ισχύουν οι σχέσεις Το Β ονομάζεται βάθος bit (bit depth) της ψηφιακής εικόνας.
Εάν η εικόνα έχει Κ στήλες και J γραμμές τότε για την απεικόνισή της απαιτούνται J×K×B bits.
Ο Πιν.1.2.1 παρουσιάζει ενδεικτικές τιμές των παραπάνω μεγεθών.
Είδος εικόνας J K B Bits bytes
Αποχρώσεων του γκρι 100 100 8 80000 10000
Ευκρίνεια της εικόνας είναι το πλήθος των εικονοστοιχείων ανά μονάδα επιφάνειας και καθορίζει πόσο λεπτομερής είναι η ψηφιακή αναπαράσταση της εικόνας.
Η ευκρίνεια Ε μιας εικόνας διαστάσεων J×K και εμβαδού Α δίνεται από την σχέση και μετριέται σε πλήθος εικονοστοιχείων ανά μονάδα επιφάνειας π.χ. pixels/mm2 ή dpi ( dots per inch : κουκίδες ανά ίντσα).
Η ευκρίνεια εξαρτάται τόσο από το πλήθος των εικονοστοιχείων όσο και από τις φυσικές διαστάσεις της εικόνας.
Μια ομάδα γειτονικών εικονοστοιχείων λέγεται γειτονιά.
Σε μια γειτονιά SM×N με Μ γραμμές και Ν στήλες μιας εικόνας διαστάσεων J×K υπάρχει ένα κεντρικό εικονοστοιχείο (jc,kc) όταν Μ, Ν είναι περιττοί αριθμοί.
Η θέση των εικονοστοιχείων της S αναφέρονται συχνά, σχετικά με την θέση του κεντρικού εικονοστοιχείου της.
Η πιο συνήθης γειτονιά είναι τριών (3) γραμμών και τριών (3) στηλών και λέγεται γειτονιά 3×3.
Στο Σχ.1.2.1 φαίνονται 3×3 και 5×5 γειτονιές.
Σε κάθε εικονοστοιχείο μιας γειτονιάς SM×N μπορούμε να αντιστοιχίσουμε έναν συντελεστή wmn , m=0,...,M-1, n=0,...,N-1.
O πίνακας WM×N λέγεται μάσκα.
Οι συντελεστές της μάσκας και οι τιμές φωτεινότητας των εικονοστοιχείων μπορούν να εμπλακούν σε χρήσιμους υπολογισμούς για την επεξεργασία της εικόνας.
Ο συνηθέστερος υπολογισμός δίνεται από την σχέση όπου (j,k) το κεντρικό εικονοστοιχείο της γειτονιάς.
Στο παρακάτω σχήμα δίνονται μάσκες 3×3 και η εφαρμογή τους σε μία 3×3 περιοχή
Αν (jc,kc) είναι το κεντρικό εικονοστοιχείο της γειτονιάς S της εικόνας ΙJ×K η τιμή Α μπορεί να αποδοθεί ως τιμή φωτεινότητας του εικονοστοιχείου (jc,kc) μιας νέας εικόνας Ι΄J×K.
Αν αυτό εφαρμοσθεί για όλες τις γειτονιές της εικόνας Ι, τότε λέμε ότι η νέα εικόνα Ι΄ προέκυψε από το φιλτράρισμα της Ι με την μάσκα W.
Αν η ψηφιακή εικόνα αποτελείται από αποχρώσεις του γκρι μπορούμε να δημιουργήσουμε την κατανομή του πλήθους των εικονοστοιχείων που έχουν την ίδια τιμή απόχρωσης για κάθε απόχρωση.
Η κατανομή αυτή λέγεται ιστόγραμμα των αποχρώσεων της εικόνας και δίνεται μαθηματικά απο την σχέση όπου g=0,1,2..G-1, G το πλήθος των αποχρώσεων, j=0,...,J-1, k=0,...,K-1, J το πλήθος των γραμμών, K το πλήθος των στηλών της εικόνας, I(j,k) η τιμή της φωτεινότητας στο σημείο (j,k) και h(g) το πλήθος των εικονοστοιχείων με απόχρωση g.
Το ιστόγραμμα δηλαδή μας πληροφορεί πόσα εικονοστοιχεία υπάρχουν με συγκεκριμένη τιμή απόχρωσης.
Η συνάρτηση λέγεται κανονικοποιημένο ιστόγραμμα και δίνει την πιθανότητα ένα τυχαίο εικονοστοιχείο της εικόνας να έχει απόχρωση g.
Κέντρο βάρους αντικειμένου.
Μία ψηφιακή δυαδική εικόνα με J γραμμές και K στήλες παριστάνεται με έναν πίνακα ΙJ×K και κάθε στοιχείο Ιjk , j=0,...,J-1, k=0,...,K-1 παίρνει τιμή μηδέν (0) ή ένα (1).
Αν η εικόνα αναπαριστά ένα αντικείμενο τότε το πλήθος των εικονοστοιχείων του αντικειμένου που έχουν τιμή ΄1΄ δίνεται από την σχέση
Το κέντρο βάρους του αντικειμένου βρίσκεται στην θέση ),( kj της εικόνας σύμφωνα με
Κωδικοποίηση δυαδικής εικόνας κατά μήκος διαδρομής
Μία δυαδική εικόνα μπορεί να κωδικοποιηθεί με κατάλληλο αλγόριθμο ώστε να ελαττωθεί η απαιτούμενη ποσότητα πληροφορίας για την αποθήκευση ή την μετάδοσή της και να διευκολυνθεί η αναγνώριση του περιεχομένου της.
Ένας τέτοιος αλγόριθμος είναι η κωδικοποίηση κατά μήκος διαδρομής ( RLE:Run Lenght Ecoding).
Σύμφωνα με αυτόν ονομάζουμε συστοιχία μία ομάδα από διαδοχικά εικονοστοιχεία με την ίδια τιμή (όλα ΄1΄ ή όλα ΄0΄) και το πλήθος των εικονοστοιχείων ως μήκος της συστοιχίας.
Διατρέχουμε κάθε σειρά της εικόνας και γράφουμε την θέση του πρώτου εικονοστοιχείου και το μήκος κάθε συστοιχίας από ΄1΄ ή εναλλακτικά την θέση του πρώτου και του τελευταίου εικονοστοιχείου κάθε συστοιχίας.
Μία άλλη προσέγγιση είναι να γράψουμε το μήκος των διαδοχικών συστοιχειών από ΄1΄ και ΄0΄ δεχόμενοι ότι η πρώτη συστοιχία αποτελείται πάντα από ΄1΄ έστω και μηδενικού μήκους.
Στο Σχ.2.2.1 που ακολουθεί φαίνεται η κωδικοποίηση των τριών πρώτων γραμμών μιας δυαδικής εικόνας με τους τρόπους που αναφέρθηκαν.
Θεωρούμε ένα σύνολο S εικονοστοιχείων μιας δυαδικής εικόνας με την ίδια τιμή (0 ή 1).
Δύο εικονοστοιχεία ρ1 και ρ2 που ανήκουν στο S ονομάζονται συνδεδεμένα όταν υπάρχει διαδρομή από εικονοστοιχεία του S που οδηγεί από το ρ1 στο ρ2.
Ένα σύνολο εικονοστοιχείων λέγεται συνδεδεμένο συστατικό (connected component) όταν όλα τα εικονοστοιχεία του είναι μεταξύ τους συνδεδμένα.
Στο ακόλουθο Σχ.2.3.1 φαίνεται ένα συνδεδεμένο και ένα μη συνδεδεμένο συστατικό δυαδικής εικόνας. (α) Συνδεμένο συστατικό (β) Μη συνδεδεμένο συστατικό
Με την κωδικοποίηση αλυσίδας κωδικοποιούμε το περίγραμμα ενός αντικειμένου της εικόνας που είναι συνδεδεμένο.
Για τον σκοπό αυτό καθορίζουμε και κωδικοποιούμε της διευθύνσεις που ξεκινούν από το κεντρικό εικονοστοιχείο και καταλήγουν στα γειτονικά του σε μια 3×3 γειτονιά. όπως φαίνεται στο Σχ.2.4.1
Ακολούθως ξεκινώντας από οποιοδήποτε εικονοστοιχείο του εξωτερικού περιγράμματος του αντικειμένου (συνήθως το πάνω αριστερό εικονοστοιχείο) διατρέχουμε το περίγραμμα γράφοντας τον κωδικό της σχετικής διεύθυνσης κάθε εικονοστοιχείου με το επόμενό του.
Στο Σχ.2.4.2 δείχνεται η εφαρμογή της κωδικοποίησης αλυσίδας.
Ο μετασχηματισμός του Hough
Συχνά οι ψηφιακές εικόνες περιέχουν γραμμές που ανήκουν σε σχήματα, τεχνικά σχέδια, γραφήματα, σειρές κειμένου ή άλλες αναπαραστάσεις.
Σε πολλές εφαρμογές είναι επιθυμητή η εύρεση της θέσης και η αναγνώριση της μορφής των γραμμών (π.χ. ευθύγραμμα τμήματα, τόξα).
Τέτοιες εφαρμογές είναι: η διανυσματική κωδικοποίηση τυπωμένων τεχνικών σχεδίων που ψηφιοποιήθηκαν από σαρωτές (scanners), η εύρεση περιοχών κειμένου σε έγγραφα, ο προσδιορισμός της υφής, βιομηχανικές εφαρμογές κατασκευών και ρομποτικής κ.α.
Ο μετασχηματισμός του Hough (HT: Hough Transform) καταδεικνύει την ύπαρξη ευθειών σε μια εικόνα και αποτελεί την βάση πολλών τεχνικών για τον προσδιορισμό ευθυγράμμων τμημάτων, καμπυλών και μορφών που αναλύονται
Ο HT προτάθηκε από τον Paul Hough το 1962 ως μέρος της κατασκευής μιας συσκευής ανίχνευσης της κίνησης σωματιδίων υψηλής ενέργειας και στόχευε στην αυτοματοποίηση και αντικατάσταση της οπτικής διαδικασίας που απαιτούσε πολλές ανθρωποώρες.
Ο αρχικός αλγόριθμος εξελίχθηκε και η σημερινή διατύπωση του είναι η ακόλουθη.
Κάθε ευθεία (ε) του καρτεσιανού επιπέδου Πxy περιγράφεται από την πολική της εξίσωση όπου (x,y) σημείο της ευθείας και ρ, θ οι πολικές της παράμετροι (Σχ.2.5.1(α)).
Το ρ είναι το μήκος του ευθύγραμμου τμήματος ΟΑ, ( )ε⊥ΟΑ και θ η γωνία που σχηματίζει το ΟΑ με τον άξονα Οχ.
Ισχύει ότι 0≥ρ και π<θ≤π−.
Θεωρούμε το επίπεδο Πθρ όπου στον κάθετο άξονα σημειώνουμε τις τιμές του ρ και στον οριζόντιο τις τιμές του θ.
Οι πολικές παράμετροι (θ,ρ) της ευθείας (ε) καθορίζουν ένα σημείο Μ(θ,ρ) στο επίπεδο Πθρ
Με τον τρόπο αυτό η ευθεία (ε) του επιπέδου Πxy αντιστοιχίζεται (μετασχηματίζεται) με την χρήση της πολικής της εξίσωσης σε ένα σημείο του επιπέδου Πθρ.
Ισοδύναμα κάθε σημείο Μ(θ,ρ) του επιπέδου Πθρ ορίζει μια ευθεία ε→ ρ = xcosθ + yημθ στο επίπεδο Πxy.
Από ένα σημείο Κ(xκ,yκ) του επιπέδου Πxy διέρχονται άπειρες ευθείες (εν), ν=1,2… που ικανοποιούν την σχέση (Σχ.2.5.2(α)).
Οι τιμές ρν και θν των μεταβλητών ρ και θ ανήκουν στην καμπύλη ρ = xκ συνθ + yκημθ του επιπέδου Πθρ.
Η καμπύλη είναι ημιτονοειδής (Σχ.2.5.2(β)), όπως δείχνεται ακολούθως.
Έστω φ η γωνία χΟΚ.
Ισχύει ότι
Αν xκ και yκ είναι θετικά (1ο τεταρτημόριο) και επειδή ρ≥0 έπεται ότι η μεγαλύτερη τιμή του ρ προκύπτει για θ=φ και είναι
Ο αναλυτικός υπολογισμός όλων των δυνατών τιμών των ρ και θ των ευθειών που ορίζουν ανά δύο τα σημεία της εικόνας και η εύρεση κοινών τιμών είναι επίπονος και πρακτικά ασύμφορος.
Για αυτό ακολουθούμε το ακόλουθο σκεπτικό.
Έστω τρία τουλάχιστον συνευθειακά σημεία στο επίπεδο Πxy με τις αντίστοιχες καμπύλες των ευθειών που διέρχονται από αυτά (Σχ.2.5.3(α)).
Οι καμπύλες αυτές τέμνονται σε σημείο Με(θε,ρε) με θε και ρε τις πολικές παραμέτρους της ευθείας που διέρχεται από αυτά (Σχ.2.5.3(β)).
Άρα αν κατασκευάσουμε τις καμπύλες του επιπέδου Πρθ για όλα τα σημεία του επιπέδου Πxy τα σημεία τομής τους έχουν συντεταγμένες τις πολικές παραμέτρους των ευθειών που ορίζουν τα σημεία αυτά.
Προφανώς, όσες καμπύλες διέρχονται από ένα σημείο τομής στο Πρθ, τόσα σημεία του Πxy ανήκουν στην ευθεία που ορίζεται από το σημείο τομής.
Προγραμματιστικά και υπολογιστικά η μέθοδος μπορεί να εφαρμοσθεί με τεχνικές όπως η ακόλουθη.
Ορίζεται ένας δισδιάστατος πίνακα HΜ Χ Ν που κβαντίζει το επίπεδο Πθρ σε Μ γραμμές και Ν στήλες με μηδενικές αρχικές τιμές.
Η ψηφιακή εικόνα με πίνακα ΙJ x K τοποθετείται στο 1ο τεταρτημόριο.
Οι συντεταγμένες ενός εικονοστοιχείου P(k,j) με I(k,j)=1 θα είναι xP=k, yP=J-j.
Επειδή η εικόνα βρίσκεται στο 1ο τεταρτημόριο το διάστημα μεταβολής της γωνίας θ μπορεί να παίρνει τιμές από –π/2 έως π.
Με βήμα κάθε δείκτης ν=1,…,Ν αντιστοιχίζεται στο διάστημα [θν, θν+Δθ), θν= -π/2+(ν-1)Δθ. κάθε δείκτης μ=1,…,Μ αντιστοιχίζεται στο διάστημα [(μ-1)Δρ, μΔρ).
Για εκείνα τα ν που ισχύει υπολογίζεται η τιμή ρ = xP συνθν + yP ημθν και ο δείκτης μ του διαστήματος που ανήκει το ρ.
Η τιμή Η(μ,ν) αυξάνεται κατά ένα.
Η διαδικασία επαναλαμβάνεται για όλα τα εικονοστοιχεία της εικόνας.
Μετά το τέλος της διαδικασίας οι υψηλές τιμές του πίνακα Η προσδιορίζουν τις πολικές παραμέτρους ευθειών της εικόνας.
Συγκεκριμένα αν Η(μ,ν) έχει υψηλή τιμή ισχύει ότι
Με κατάλληλες τεχνικές είναι δυνατή η βελτίωση της οπτικής εμφάνισης μιας εικόνας ώστε να είναι καλύτερα αντιληπτή από τον άνθρωπο ή κατάλληλη για περαιτέρω επεξεργασία.
Συχνά στις εικόνες εμφανίζονται μικροκουκίδες που οφείλονται σε τυχαίους παράγοντες (θόρυβος).
Το φίλτρο της μέσης τιμής (median filter) είναι μια απλή τεχνική εξάλειψης και εξομάλυνσης του θορύβου αυτού από ψηφιακές εικόνες αποχρώσεων του γκρι.
Σύμφωνα με την τεχνική αυτή από την αρχική εικόνα Ι παράγεται μία νέα εικόνα Ι΄ ιδίων διαστάσεων κάθε εικονοστοιχείο (j,k) της οποίας έχει φωτεινότητα Ι΄(j,k) που είναι η μέση τιμή των τιμών φωτεινότητας μιας γειτονιάς του εικονοστοιχείου (j,k) της εικόνας Ι.
Αν για παράδειγμα κάθε περιοχή S είναι 3×3 τότε το Ι΄(jc,kc) δίνεται από την σχέση
Με άλλα λόγια η εικόνα Ι΄ είναι το αποτέλεσμα του φιλτραρίσματος της αρχικής εικόνας
Ειναι δυνατόν να χρησιμοποιηθούν και άλλες μάσκες για την εξομάλυνση μιας εικόνας όπως για παράδειγμα η 1=W.
Μάσκες 5×5 ή μεγαλύτερες εξομαλύνουν ακόμα περισσότερο την εικόνα.
Μια άλλη μέθοδος εξομάλυνσης είναι το φίλτρο της ενδιάμεσης τιμής.
Σύμφωνα με την τεχνική αυτή οι τιμές των εικονοστοιχείων μιας γειτονιάς ταξινομούνται και η τιμή του εικοστοιχείου Ι΄(j,k) είναι η μεσαία από τις τιμές των εικονοστοιχείων της γειτονιάς του Ι(j,k).
Στο Σχ.3.1.1 που ακολουθεί φαίνονται οι τιμές που προκύπτουν από την εξομάλυνση ενός μέρους μιας εικόνας α) με το φίλτρο της μέσης τιμής και β) με το φίλτρο της
Τιμές φωτεινότητας της αρχικής εικόνας.
Οι τιμές φωτεινότητας μετά από εξομάλυνση με το φίλτρο της μέσης τιμής.
Οι τιμές φωτεινότητας μετά από εξομάλυνση με το φίλτρο της ενδιάμεσης τιμής.
Το φίλτρο της μέσης τιμής απομακρύνει τον θόρυβο χωρίς να επηρεάσει ιδιαίτερα τις ακμές της εικόνας.
Το φίλτρο της ενδιάμεσης τιμής απομακρύνει τον θόρυβο και εξομαλύνει τις ακμές της εικόνας.
Εξισορρόπηση του ιστογράμματος Η διάκριση γειτονικών περιοχών σε εικόνες αποχρώσεων του γκρι, είναι δύσκολη όταν η διαφορά τιμών των αποχρώσεων είναι μικρή.
Η αύξηση των χρωματικών αντιθέσεων μιας εικόνας διευκολύνει την διάκριση των περιοχών αυτών.
Μια τεχνική για την επίτευξη αυτού του σκοπού είναι η εξισορρόπηση του ιστογράμματος της εικόνας (Histogram equalization).
Σύμφωνα με αυτήν οι τιμές των αποχρώσεων των εικονοστοιχείων μεταβάλλονται έτσι ώστε να αυξηθεί η αντίθεση μεταξύ των περιοχών με διαδοχικές τιμές αποχρώσεων ανάλογα με το ποσοστό του πλήθους των εικονοστοιχείων τους.
Συγκεκριμένα, αν G είναι το πλήθος όλων των αποχρώσεων της παλέτας του γκρι, h(g) το κανονικοποιημένο ιστόγραμμα της αρχικής εικόνας ΙKXJ, g=0,1,…,G-1 και P(g) η συνάρτηση αθροιστικής πιθανότητας του g, προκύπτει μία νέα εικόνα Ι΄ ίδιων διαστάσεων με τη Ι, κάθε εικονοστοιχείο (k,j) της οποίας έχει απόχρωση I΄(k,j) = [(G-1)P(I(k,j)].
Με άλλα λόγια κάθε τιμής g μιας απόχρωση της αρχικής εικόνας αντικαθίσταται από μια τιμή g΄ = [(G-1)P(g)].
Υπενθυμίζεται ότι για την P(g)
Παράδειγμα: Έστω ο ακόλουθος πίνακας τιμών των αποχρώσεων του γκρι μιας
Οι αποχρώσεις g΄ προκύπτουν σύμφωνα με τους ακόλουθους υπολογισμούς:
Στο Σχ.3.1.2.1 δείχνονται τα ιστογράμματα h(g) και h(g΄).
Στο Σχ.3.1.2.2 φαίνεται η εφαρμογή της εξισορρόπησης του ιστογράμματος στην εικόνα με
Συχνά τα εικονοστοιχεία ενός αντικειμένου μιας εικόνας παίρνουν τιμές σε ένα μικρό διάστημα αποχρώσεων.
Αυτό οδηγεί συνήθως στη δημιουργία ενός τοπικού μέγιστου στην περιοχή του ιστογράμματος της εικόνας.
Η εύρεση τέτοιων τοπικών μεγίστων διευκολύνει τον εντοπισμό των αντικειμένων της εικόνας και την απόδοσή της με λιγότερες κύριες αποχρώσεις.
Παρακάτω θα περιγράψουμε διάφορες τεχνικές για τον καθορισμό τιμών του πεδίου των αποχρώσεων μεταξύ των οποίων εμφανίζονται τοπικά μέγιστα του ιστογράμματος.
Οι τιμές αυτές λέγονται κατώφλια.
Για την μετατροπή μιας εικόνας αποχρώσεων του γκρι σε δυαδική είναι επιθυμητός ο προσδιορισμός των 2 κύριων αποχρώσεών της.
Με τον τρόπο αυτό οι αποχρώσεις της εικόνας χωρίζονται σε 2 κλάσεις C1, C2 που κάθε μια αποτελείται από τις αποχρώσεις που βρίσκονται πιο κοντά σε μια από τις 2 κύριες αποχρώσεις.
Ο διαχωρισμός αυτός ισοδυναμεί με την εύρεση μιας τιμής κατωφλιού Τ για την οποία θα ισχύει
Ακολούθως από την αρχική εικόνα I προκύπτει η δυαδική εικόνα I΄ κάθε εικονοστοιχείο της οποίας δίνεται από τη σχέση
Κατωφλίωση με βάση τη διασπορά
Μια μέθοδος για την εύρεση της τιμής κατωφλίου Τ είναι η μέθοδος του Οtsu.
Σύμφωνα με αυτήν η τιμή Τ πρέπει να είναι τέτοια ώστε η συνολική εσωτερική διασπορά 2wσ εντός των κλάσεων να είναι ελάχιστη και η συνολική διασπορά 2bσ μεταξύ των κλάσεων μέγιστη.
Σύμφωνα με την μέθοδο δημιουργούμε το κανονικοποιημένο ιστόγραμμα h(g) της εικόνας).
Η συνάρτηση h(g) δίνει την πιθανότητα να έχει ένα τυχαίο εικονοστοιχείο της εικόνας
Έστω Τ μια τιμή κατωφλιού που διαχωρίζει τις αποχρώσεις σε δύο κλάσεις C1 (g<T) και C2 (T≤g).
Η πιθανότητα ένα τυχαίο εικονοστοιχείο να έχει απόχρωση της κλάσεως C1 είναι p1 και δίνεται από τη σχέση όμοια για την κλάση C2 είναι p2 και δίνεται από τη σχέση
Είναι προφανές ότι ισχύει
Η μέση τιμή μ1 της πρώτης κλάσης είναι
Η μέση τιμή μ2 της δεύτερης κλάσης είναι και ισούται με
Η συνολική μέση τιμή μ δίνεται από τη σχέση
Από τις τρείς προηγούμενες σχέσεις εύκολα αποδεικνύεται η σχέση
Η διασπορά της πρώτης κλάσης δίνεται από τη σχέση και η διασπορά της δεύτερης κλάσης είναι
H συνολική διασπορά 2σ είναι
Η συνολική εσωτερική διασπορά των κλάσεων ορίζεται από τη σχέση
Η συνολική διασπορά μεταξύ των κλάσεων ορίζεται από τη σχέση
Αναζητούμε τώρα την κατάλληλη τιμή του Τ ώστε η 2wσ να είναι ελάχιστη και 2bσ μέγιστη.
Προς τούτο θεωρούμε το πηλίκο και ζητάμε την τιμή του Τ για την οποία το λ μεγιστοποιείται.
Για να μειωθούν οι υπολογισμοί θεωρούμε τις σχέσεις
H σχέση 222 bw σσσ += αποδεικνύεται στο παράρτημα Α.
Επειδή το σ2 είναι ανεξάρτητο του Τ και η συνάρτηση λ/(1+λ) είναι αύξουσα συνεπάγεται πως για να είναι το λ μέγιστο αρκεί να είναι το 2bσ μέγιστο.
Με τον τρόπο αυτό η τελικά η κατάλληλη τιμή του κατωφλίου Τ είναι εκείνη που μεγιστοποιεί την ποσότητα
Δίνεται ο πίνακας ψηφιακής εικόνας αποχρώσεων του γκρι.
Ποια η τιμή κατωφλίωσης της με τη μέθοδο της διασποράς;
Η μέγιστη τιμή του 2bσ προκύπτει για Τ=200 που αποτελεί σύμφωνα με τη μέθοδο η καλλίτερη τιμή για την κατωφλίωση
Κατωφλίωση με βάση την εντροπία
Μια διαφορετική προσέγγιση για την εύρεση κατάλληλης τιμής κατωφλίου Τ βασίζεται στην έννοια της εντροπίας.
Σύμφωνα με την εκδοχή που παρουσίασε ο Kapur, η τιμή Τ χωρίζει το κανονικοποιημένο ιστόγραμμα h(g) σε δυο κλάσεις c1 και c2.
Η πρώτη κλάση μπορεί να θεωρηθεί ως πηγή πληροφορίας με σύμβολα g = 0, …Τ-1 και αντίστοιχες
Η μέση πληροφορία (εντροπία) που προκύπτει της c1 είναι
Όμοια η μέση πληροφορία που προκύπτει από την c2 είναι
Ζητείται η πρώτη κλάση που θα αντιστοιχηθεί στην τιμή ‘0’ και η δεύτερη που θα αντιστοιχηθεί στο ‘1’ να προσφέρουν συνολικά την μεγαλύτερη δυνατή μέση πληροφορία.
Δηλαδή η ζητούμενη τιμή του κατωφλίου Τα είναι εκείνη για την οποία Ε1(Τ)+Ε2(Τ) γίνεται
Εάν κάθε αντικείμενο της εικόνας αποτελείται από μία κύρια και κάποιες παραπλήσιες αποχρώσεις του γκρι , τότε δημιουργείται η συσσώρευση των τιμών του ιστογράμματος σε συγκεκριμένες περιοχές.
Η επιλογή πολλαπλών κατωφλίων μπορεί να θεωρηθεί ως ένα πρόβλημα εύρεσης τιμών 1J,...,2,1k),k(T −= με σκοπό το μετασχηματισμό της αρχικής εικόνας με L αποχρώσεις του γκρι σε μια νέα με J αποχρώσεις.
Ειδικότερα για T(1)<T(2)<…<T(J-1), τότε η νέα εικόνα ορίζεται ως όπου G μία συνάρτηση τιμών των επιπέδων του γκρι.
Μία τεχνική πολλαπλών κατωφλίων που βασίζεται στο ιστόγραμμα πρέπει να πετυχαίνει έναν ικανοποιητικό διαχωρισμό των διαφόρων περιοχών του ιστογράμματος.
Οι μέθοδοι της διασποράς και της εντροπίας είναι δυνατόν να εφαρμοσθούν και στην επίλυση του προβλήματος της πολυκατωφλίωσης, έχουν όμως μεγάλο υπολογιστικό κόστος.
Μία αποτελεσματική προσέγγιση είναι να θεωρήσουμε την εύρεση πολλαπλών κατωφλίων ως πρόβλημα εύρεσης κλάσεων (clustering problem).
Ένα κατάλληλο νευρωνικό δίκτυο μπορεί να λύσει αποτελεσματικά προβλήματα εύρεσης κλάσεων.
Είναι γνωστό ότι ο κύριος σκοπός ενός νευρωνικού δικτύου Kohonen για την δημιουργία ενός αυτό- οργανούμενου πίνακα απεικόνισης χαρακτηριστικών (SOFM: Self Organized Feature Map) είναι η αντιπροσώπευση ενός πολυπληθούς συνόλου διανυσμάτων εισόδου με ένα ολιγομελέστερο σύνολο “πρωτοτύπων ανυσμάτων” ώστε να επιτευχθεί μια καλή προσέγγιση του αρχικού χώρου εισόδου που να ικανοποιεί τα κύρια στατιστικά χαρακτηριστικά του.
Θεωρούμε ένα δίκτυο με νευρώνες (κόμβους) όπως στο Σχ.3.2.3.1 – Συγκροτείται το σύνολο εκπαίδευσης του ΑΠΑΧ από τις τιμές των αποχρώσεων των εικονοστοιχείων της εικόνας. – Θεωρούμε τη μεταβλητή επανάληψης t που παίρνει ακέραιες τιμές από 0 μέχρι μία προκαθορισμένη τελική τιμή Τ (π.χ.
Τ=100.000). – Θεωρούμε τη μεταβλητή του ρυθμού εκμάθησης α(t). – Θεωρούμε το μήκος d(t) που ορίζει μια υποπεριοχή (γειτονιά) στην διάταξη των – Έστω wj το βάρος της σύναψης μεταξύ του j νευρώνα του επιπέδου ανταγωνισμού και της εισόδου του.
Εκτελούνται τα παρακάτω βήματα: Βήμα 1.
Αρχικοποιούνται (t=0) τα βάρη των συνάψεων wj(0) με τυχαίες τιμές από 255.
Βήμα 2.
Αρχικοποιείται η α(0) με μια μεγάλη τιμή, συνήθως μεταξύ 0.2 και 0.5.
Βήμα 3.
Αρχικοποιείται η d(0) με την τιμή J/2, που είναι ίση με το μισό του εύρους του
Γειτονιά του j νευ-
Βήμα 4.
Επιλέγεται τιμή απόχρωσης Ι(x,y) ενός τυχαίου εικονοστοιχείου από το σύνολο
Βήμα 5.
Υπολογίζεται η έξοδος oj(t) κάθε νευρώνα από τη σχέση Βήμα 6.
Ο νευρώνας c ανακηρύσσεται νικητής εάν ικανοποιείται η συνθήκη
Εάν οι έξοδοι δύο νευρώνων είναι ίσες, τότε κατά σύμβαση επιλέγεται αυτός με το
Βήμα 7.
Tα βάρη wj των συνάψεων ανανεώνονται σύμφωνα με τις παρακάτω σχέσεις όπου Nc το σύνολο των δεικτών των νευρώνων που βρίσκονται μέσα στην γειτονιά του νικητή νευρώνα και πλευρά d(t).
Βήμα 8.
Αυξάνεται η μεταβλητή επανάληψης κατά ένα και αποδίδονται νέες τιμές στις μεταβλητές α(t), d(t) σύμφωνα με τις σχέσεις:
Τα βήματα 4 έως 8 επαναλαμβάνονται έως ότου η μεταβλητή t πάρει τη μέγιστη τελική τιμή Τ.
Είναι φανερό πως οι μεταβλητές α(t) και d(t) συγκλίνουν στο μηδέν καθώς η t τείνει στην
Μετά την εκπαίδευση κάθε άνυσμα εισόδου του ΑΠΑΧ αποδίδεται στον νικητή νευρώνα.
Κάθε νευρώνας του επιπέδου εξόδου αντιπροσωπεύει μία ομάδα προτύπων (cluster).
Πρότυπα με μεγάλη ομοιότητα αντιπροσωπεύονται από τον ίδιο νευρώνα.
Ο χάρτης χαρακτηριστικών του Kohonen οργανώνει τους νευρώνες του επιπέδου ανταγωνισμού με τέτοιο τρόπο ώστε οι ομοιότητες μεταξύ των προτύπων να απεικονίζονται με σχέσεις γειτνίασης επάνω στον κάναβο του επιπέδου ανταγωνισμού Στο Σχ. 3.2.3.1 φαίνεται η αρχική εικόνα στην οποία θα εφαρμοσθεί πολυκατωφλίωση
Μετά την εκπαίδευση ενός ΝΔ Kohonen για την πολυκατωφλίωση των νευρώνων προκύπτουν οι τιμές των βαρών που αναγράφονται στον Πιν. 3.2.3.1 και οι τιμές των κατωφλίων του Πιν.3.2.3.2.
Οι τιμές αυτές αποτελούν ουσιαστικά ένα μικρότερο πλήθος αποχρώσεων για την απόδοση της αρχικής εικόνας.
Πίνακας 3.2.3.1: Οι τιμές των συντελεστών του ΝΔ μετά την εκπαίδευση.
Πίνακας 3.2.3.2.
Οι τιμές των κατωφλίων.
Στον Πιν. 3.2.3.3 φαίνονται οι τιμές των κατωφλίων για διαφορετικό πλήθος (J) νευρώνων του νευρωνικού δικτύου
Πίνακας 3.2.3.3.
Οι τιμές των κατωφλίων για J=2,…,6.
Πλήθος αποχρώσεων 2 Πλήθος αποχρώσεων 3 για διαφορετικό πλήθος κατωφλίων και αποχρώσεων.
Η βέλτιστη τιμή του J για ένα δεδομένο σύνολο τιμών {2,…,Jmax} ελαχιστοποιεί το σφάλμα προσαρμογής μεταξύ των συναρτήσεων H( l ) και HJ( l ).
Η συνάρτηση H( l ) υπολογίζεται από και είναι συνάρτηση πυκνότητας πιθανότητας επειδή 1)(H
Η πιθανότητα fj εμφάνισης της κλάσης Cj, η μέση τιμή μj της κλάσης και η διασπορά της jσ δίνονται αντίστοιχα από τις σχέσεις
Η συνάρτηση προσαρμογής )(HJ l είναι το άθροισμα
Μπορεί να δειχθεί εύκολα ότι η )(lJh είναι επίσης συνάρτηση πυκνότητας πιθανότητας.
Το σφάλμα προσαρμογής Je για ένα πλήθος κλάσεων J ορίζεται ως και υπολογίζεται για J=2,…,Jmax.
Η τιμή Jo είναι βέλτιστη όταν το αντίστοιχο σφάλμα oJe ικανοποιεί τη συνθήκη
Ο Πίν. 3.2.3.3 δείχνει τις τιμές του Je για J=2,…,6.
Η μικρότερη από αυτές τις τιμές προκύπτει για J=3 και θεωρείται ότι είναι η βέλτιστη τιμή Jo.
Όπως μπορεί να παρατηρηθεί από το ιστόγραμμα )(h l (Σχ. 3.2.3.3), αυτή η τιμή είναι κατάλληλη επειδή αντιστοιχεί στο πλήθος των σημαντικών υψωμάτων του ιστογράμματος.
Για την αναπαράσταση μια ψηφιακής εικόνας J γραμμών και Κ στηλών με βάθος χρώματος (bit) Β bits απαιτούνται J×K×B bits.
H κωδικοποίηση μιας συγκεκριμένης ψηφιακής εικόνας με τέτοιο τρόπο δεν είναι η πλέον κατάλληλη όταν ενδιαφέρει το πλήθος των bits που δαπανώνται.
Αυτό συχνά συμβαίνει σε περιπτώσεις μετάδοσης ή αποθήκευσης της εικόνας.
Με τον όρο συμπίεση της εικόνας αναφερόμαστε σε ένα πλήθος τεχνικών που στοχεύουν στην μείωση του πλήθους των bits που απαιτούνται για την κωδικοποίηση της εικόνας.
Οι τεχνικές αυτές διακρίνονται σ αυτές που επιτρέπουν απώλεια πληροφορίας και αυτές που δεν επιτρέπουν.
Στην πρώτη περίπτωση η πληροφορία που χάνεται δεν θα πρέπει να είναι ζωτικής σημασίας για τον παρατηρητή της εικόνας.
Ακολούθως θα περιγραφούν αλγόριθμοι συμπίεσης ψηφιακών εικόνων αποχρώσεων του γκρι.
Σύμφωνα με την τεχνική αυτή κωδικοποιούμε τις αποχρώσεις του γκρί μιας συγκεκριμένης εικόνας με κωδικές λέξεις μεταβλητού μήκους.
Μια απόχρωση που εμφανίζεται συχνά (με μεγάλη πιθανότητα) στην εικόνα κωδικοποιείται με λέξη μήκους μικρότερου από άλλες αποχρώσεις που εμφανίζονται σπανιότερα.
Το κανονικοποιημένο ιστόγραμμα h(g) των αποχρώσεων της ψηφιακής εικόνας παρέχει τις τιμές της πιθανότητας εμφάνισης p(g) των τιμών της μεταβλητής g των αποχρώσεων της εικόνας διότι p(g)=h(g).
Αν l(g) είναι το μήκος της κωδικής λέξης της g απόχρωσης και G το πλήθος των αποχρώσεων, τότε το μέσο μήκος του κώδικα που απαιτείται για την εικόνα είναι
Ένας κατάλληλος ευκρινής, μονοσήμαντος και στιγμιαία αποκωδικοποιήσιμος κώδικας που ελαχιστοποιεί το μέσο μήκος είναι ο κώδικας Huffman.
Αν η εικόνα κωδικοποιηθεί σύμφωνα με αυτόν η τιμή του σύμφωνα με την θεωρία της πληροφορίας θα ικανοποιεί τη σχέση
Όπου Η(G) η εντροπία της εικόνας αν την θεωρήσουμε ως πηγή πληροφορίας που δίνεται από την σχέση
Ο εύρεση του κώδικα Huffman για μια συγκεκριμένη εικόνα γίνεται με την δημιουργία ενός δυαδικού δένδρου.
Τα φύλλα του δένδρου είναι οι τιμές των αποχρώσεων με τις αντίστοιχες πιθανότητες εμφάνισης τους στην εικόνα.
Τα φύλλα συνενώνονται σε δυαδικούς κόμβους.
Σε κάθε κόμβο αντιστοιχίζεται το άθροισμα των πιθανοτήτων εμφάνισης των παιδιών του.
Ο πρώτος κόμβος δημιουργείται από τη συνένωση των δύο αποχρώσεων (φύλλα) με τις μικρότερες πιθανότητες.
Κάθε επόμενος κόμβος έχει δύο παιδιά που επιλέγονται από φύλλα ή διαθέσιμους κόμβους που δεν ενώθηκαν και έχουν τις μικρότερες πιθανότητες εμφάνισης..
Στο ακόλουθο παράδειγμα παρουσιάζεται εφαρμογή της κωδικοποίησης σε μια εικόνα αποχρώσεων του γκρι διαστάσεων 4 × 5.
Για την εικόνα του παραδείγματος απαιτούνται 1×5+1×5+2×4+4×3+7×2+5×2+5×2=54 bits αντί των 25×3=75 bits που απαιτούνται για κωδικές λέξεις σταθερού μήκους τριών bits (3=[log27]+1).
Το μέσος μήκος κωδικολέξης 16.225/54 ==l και ο ποσοστό συμπίεσης
Κωδικοποίηση 2Δ-διακριτού μετασχηματισμό συνημιτόνου
Από όσα αναφέρθηκαν προηγουμένως η διαδικασία της κωδικοποίησης σχετιζόταν άμεσα με τις τιμές των εικονοστοιχείων της εικόνας.
Στην ενότητα αυτή θα δούμε τον μετασχηματισμό του διδιάστατου ψηφιακού σήματος με την εύρεση των προβολών του (συντελεστών) σε μία ορθοκανονική βάση, πριν ακολουθήσει η διαδικασία κωδικοποίησης Ο διδιάστατος μετασχηματισμός συνημιτόνου (2D-DCT: Discrete Cosine Transform) αποτελεί την βάση για συμπίεση μη δυαδικών εικόνων με αποδεκτή απώλεια πληροφορίας.
Η τυποποίηση JPEG βασίζεται στις πρώτες εκδόσεις της στον 2D-DCT.
Θα αρχίσουμε την παρουσίαση του μετασχηματισμού από την μονοδιάστατη εκδοχή του. για k=1..N-1 και n=0,..,Ν-1 είναι ένας πυρήνας (kernel) δημιουργίας ορθοκανονικών διανυσμάτων για κάθε τιμή του Ν.
Οι συντελεστές ck για ένα διακριτό σήμα x(n) πεπερασμένου μήκους Ν (δηλαδή οι προβολές του x στα gk) προκύπτουν από τη σχέση:
Η σχέση αυτή αποτελεί τον μονοδιάστατο διακριτό μετασχηματισμό συνημιτόνου (1D-DCT: Discrete Cosine Transform).
Οι τιμές x(n) (δηλαδή το x) προκύπτουν από τη σχέση
Η σχέση αυτή αποτελεί τον αντίστροφο διακριτό μετασχηματισμό του συνημιτόνου.
Στο Σχ. 3.3.2.1 δείχνονται τα ανύσματα βάσης του DCT για Ν=8. προήλθαν από τις σχέσεις
Και αποτελούν μία ορθοκανονική βάση και το σήμα x=[1, 3, 2]Τ προβάλλεται σ’ αυτά με προβολές που δίνουν οι συντελεστές 32c0 = , 2/2c1 −= , 2/6c2 −=.
Για n=0,1,2
Για x=[1, 3, 2, -1]Τ η τιμή Ν=4 και για n=0,1,2,3 τα ανύσματα βάσης είναι:
Οι συντελεστές ck είναι τα στοιχεία του πίνακα οι συντελεστές ck προκύπτουν όμοια και από τις (3.3.2.1) Το σήμα ανακτάται από τις σχέσεις (3.3.2.2) ή από τον πίνακα
Στο Σχ. 3.3.2.2 δείχνονται τα ανύσματα βάσης του DCT για Ν=4, οι συντελεστές ck του DCT του σήματος x=[1, 3, 2, -1] και η ανάλυση του στις τέσσερις συνιστώσες ckgk.
Κάθε τιμή του
Για διακριτά σήματα δύο διαστάσεων με μήκη Ν1, Ν2 τα ανύσματα βάσης για n1=0,..,N1-1,
Για ένα δισδιάστατο διακριτό σήμα x(n1,n2) με μήκη Ν1, Ν2, οι προβολές του στα παραπάνω ορθοκανονικά ανύσματα βάσης είναι:
Οι παραπάνω σχέσεις αποτελούν τον δισδιάστατο (2Δ) διακριτό μετασχηματισμό συνημιτόνου (2D-DCT: Discrete Cosine Transform).
Το σήμα x[n1,n2] ανακτάται σύμφωνα με που είναι ο αντίστροφος δισδιάστατος (2Δ) διακριτός μετασχηματισμός συνημιτόνου.
Είναι προφανές από τα παραπάνω αν Μ×Ν είναι τα εικονοστοιχεία της εικόνας τότε Μ×Ν θα είναι και όλοι οι συντελεστές του 2D-DCT αυτής.
Για παράδειγμα για μία εικόνα 8×8, ο μετασχηματισμός οδηγεί στον υπολογισμό 8×8 συντελεστών (προβολών) για κάθε μία από τις 8×8 διακριτές διδιάστατες ακολουθίες βάσης.
Κάθε ακολουθία της βάσης έχει τιμές που δίνονται από τις (3.3.2.3) που αν παρασταθούν με τόνους του γκρι προκύπτουν οι εικόνες του
Μετασχηματισμοί των οποίων η βάση ικανοποιεί την (3.3.2.1) λέγονται διαχωρίσιμοι και οι υπολογισμοί τους μπορούν να αναχθούν σε υπολογισμούς των μονοδιάστατων εκφράσεών τους.
Η εφαρμογή του 2D-DCT στην συμπίεση εικόνων αποχρώσεων του γκρι σύμφωνα με την τυποποίηση JPEG (Join Photographic Experts Group) ακολουθεί τα ακόλουθα γενικά βήματα: Η εικόνα χωρίζεται σε μη επικαλυπτόμενα τμήματα 8×8 εικονοστοιχείων.
Οι τιμές των εικονοστοιχείων μετατρέπονται από το διάστημα [0,2L-1] στο διάστημα [- 2L-1, 2L-1-1] με την αφαίρεση από κάθε τιμή του αριθμού 2L-1, όπου L το βάθος χρώματος της εικόνας (bits/pel).
Για κάθε τμήμα υπολογίζονται οι συντελεστές του 2D-DCT.
Ακολούθως οι τιμές κβαντίζονται και τέλος Κωδικοποιούνται κατά Huffman.
Στο Σχ. 3.2.3.4 η αρχική εικόνα 256×256 pels χωρίζεται σε τμήματα των 8×8 pels και σε κάθε ένα από αυτά εφαρμόζεται ο 2D-DCT, ακολούθως με χρήση μόνο των 8 συντελεστών αναδημιουργείται η εικόνα με σφάλμα όπως φαίνεται στο σχήμα.
Σε μια εικόνα αποχρώσεων του γκρι υπάρχουν περιοχές εικονοστοιχείων με απότομη αύξηση της φωτεινότητας.
Οι περιοχές αυτές βρίσκονται στα όρια των τμημάτων της εικόνας που έχουν σημαντικά διαφορετικές αποχρώσεις.
Η ανίχνευση των ορίων αυτών λέγεται προσδιορισμός των ακμών της εικόνας (edge detection).
Η ανίχνευση ακμών είναι εξαιρετικά χρήσιμη εργασία στην ανάλυση των εικόνων διότι μέσω αυτής προσδιορίζονται τα περιγράμματα των αντικειμένων της εικόνας.
Υπάρχει πληθώρα αλγορίθμων που αφορούν την επίλυση του προβλήματος, όμως όλοι βασίζονται στην έννοια της κλίσης της συνάρτησης φωτεινότητας Ι(k,j) στη θέση (k, j) ενός εικονοστοιχείου της εικόνας.
Το αποτέλεσμα της όλης εργασίας είναι μια νέα δυαδική εικόνα, ιδίων διαστάσεων με την αρχική, όπου τα εικονοστοιχεία του αντικειμένου είναι οι ακμές της αρχικής εικόνας, Στο ακόλουθο σχήμα φαίνονται σε μία διάσταση, τύποι ακμών που διαφέρουν ως προς την κλίση τους.
Η κλίση μιας συνεχούς συνάρτησης ℜ→ℜ2:)y,x(f είναι ένα διάνυσμα στο επίπεδο xy που ορίζεται σύμφωνα με την σχέση
Το μέτρο του διανύσματος κλίσης σε ένα σημείο (x,y) δείχνει πόσο απότομη είναι η ακμή και
Η κλίση στο σημείο (x,y) είναι μέγιστη αν κινηθούμε κατά την διεύθυνση του xy επιπέδου που προσδιορίζει η γωνία φ σύμφωνα με την σχέση
Μια ψηφιακή εικόνα δεν είναι συνεχής συνάρτηση και ως εκ τούτου αντί των μερικών παραγώγων υπολογίζουμε τις διαφορές της απόχρωσης ενός εικονοστοιχείου με τα γειτονικά του, κατά την οριζόντια και κάθετη κατεύθυνση της εικόνας.
Αν εφαρμοσθεί η προσέγγιση αυτή σε ένα εικονοστοιχείο (k, j) με το προηγούμενό του, στον πίνακα Ι μιας ψηφιακής εικόνας, τότε η κλίση σ’αυτό καθορίζεται από το διάνυσμα
Όμοια για ένα εικονοστοιχείο και τα εκατέρωθεν αυτού εικονοστοιχεία καθορίζεται η κλίση
Τα παραπάνω μπορούν να εκφρασθούν και με την χρήση μασκών όπως ακολούθως
Αν εφαρμόσουμε όλες τις παραπάνω μάσκες σε μία εικόνα 3Χ3, και αντιστοιχίσουμε το άθροισμα των αποτελεσμάτων στο κεντρικό εικονοστοιχείο, θα προκύψουν για κάθε κατεύθυνση αντίστοιχα οι τιμές ή με την μορφή μάσκας
Η μάσκα αυτή λέγεται ανιχνευτής ακμών του Sobel (Sobel edge detector) και λειτουργεί ως διάνυσμα (Sk, Sj) με τις οικίες τιμές κατεύθυνσης και πλάτους.
Πολλές μάσκες έχουν προταθεί από τους ερευνητές για την ανίχνευση ακμών βασισμένες σε διαφορετικές προσεγγίσεις για την εξυπηρέτηση διαφόρων ιδιαιτεροτήτων των εικόνων.
Σε κάθε περίπτωση από την αρχική εικόνα παράγεται ένας πίνακας τιμών του μέτρου της κλίσης σε κάθε εικονοστοιχείο της εικόνας.
Ακολούθως μία τιμή κατωφλίου καθορίζει εκείνα τα εικονοστοιχεία που αντιστοιχούν σε ακμές και παράγουν την δυαδική εικόνα των ακμών.
Η επιλογή της κατάλληλης τιμής κατωφλίου είναι ένα επιπρόσθετο πρόβλημα.
Η μεταβολή του φωτισμού, η μεταβολή της απόχρωσης του αντικειμένου ή του παρασκηνίου, απαιτούν την χρήση διαφορετικών τοπικών τιμών κατωφλίων.
Η εύρεση των περιοχών που το μέτρο της κλίσης (άνυσμα πρώτων μερικών παραγώγων) έχει τοπικά μεγάλες τιμές μπορεί βασισθεί στην εύρεση περιοχών όπου η δεύτερες μερικές παράγωγοι της συνάρτησης της εικόνας μηδενίζονται.
Σε μία ψηφιακή εικόνα η δεύτερη παράγωγος κατά την οριζόντια διεύθυνση βασίζεται στην διπλή διαδοχική εφαρμογή του ∂ αντικαθίσταται από την διαφορά
Μπορούμε να εφαρμόσουμε τα παραπάνω σε μία μάσκα 3 Χ 3 με τιμές
Η μάσκα αυτή είναι μία έκφραση του τελεστή Laplace μιας συνάρτησης f(x,y) στο πίνακα Ι(k,j).
Οι ακμές αποδίδονται στα εικονοστοιχεία που αντιστοιχούν σε μηδενικές τιμές του πίνακα που προέρχεται από την εφαρμογή του ∇2 ή στα εικονοστοιχεία που έχουν διαφορετικό πρόσημο με τα γειτονικά τους.
Το πλεονέκτημα του τελεστή Laplace είναι ότι βρίσκει τα τοπικά μέγιστα της πρώτης παραγώγου και δημιουργεί λεπτές ακμές.
Μειονεκτεί διότι είναι ευαίσθητος στο θόρυβο και στις μικρές αυξομειώσεις της έντασης της φωτεινότητας.
Για το λόγο αυτό εφαρμόζεται σε συνδυασμό με τον ∇1 ή ∇2, τεχνικές τοπικής διασποράς και αφαίρεσης θορύβου.
Για το πρόβλημα ανίχνευσης των ακμών χρησιμοποιούνται σήμερα πιο πολύπλοκες τεχνικές που αντιμετωπίζουν προβλήματα όπως θορύβου, αλλοίωσης του φωτισμού κ.α.
Από τις πλέον επιτυχημένες και διαδεδομένες είναι του Canny και θα την παρουσιάσουμε ακολούθως.
